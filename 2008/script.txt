create table votacao_secao_2008(
    DATA_GERACAO STRING,
    HORA_GERACAO STRING,
    ANO_ELEICAO STRING,
    NUM_TURNO STRING,
    DESCRICAO_ELEICAO STRING,
    SIGLA_UF STRING,
    SIGLA_UE STRING,
    CODIGO_MUNICIPIO STRING,
    NOME_MUNICIPIO STRING,
    NUM_ZONA STRING,
    NUM_SECAO STRING,
    CODIGO_CARGO STRING,
    DESCRICAO_CARGO STRING,
    NUM_VOTAVEL STRING,
    QTDE_VOTOS STRING) 
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
'separatorChar' = '\;',
'quoteChar'     = '\"',
'serialization.encoding'='ISO-8859-1'
)
STORED AS TEXTFILE;
Alter table votacao_secao_2008 set location 's3://datascience2016/data/gzip/votacao_secao/2008/';


create table legenda_2008(
    DATA_GERACAO STRING,
    HORA_GERACAO STRING,
    ANO_ELEICAO STRING,
    NUM_TURNO STRING,
    DESCRICAO_ELEICAO STRING,
    SIGLA_UF STRING,
    SIGLA_UE STRING,
    NOME_UE STRING,
    CODIGO_CARGO STRING,
    DESCRICAO_CARGO STRING,
    TIPO_LEGENDA STRING,
    NUM_PARTIDO STRING,
    SIGLA_PARTIDO STRING,
    NOME_PARTIDO STRING,
    SIGLA_COLIGACAO STRING,
    NOME_COLIGACAO STRING,
    COMPOSICAO_COLIGACAO STRING,
    SEQUENCIA_COLIGACAO STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
'separatorChar' = '\;',
'quoteChar'     = '\"'
)
STORED AS TEXTFILE;
Alter table legenda_2008 set location 's3://datascience2016/data/gzip/legendas/legendas_2008.csv.gz';

create table candidato_2008 
(DATA_GERACAO STRING,
HORA_GERACAO STRING,
ANO_ELEICAO STRING,
NUM_TURNO STRING,
DESCRICAO_ELEICAO STRING,
SIGLA_UF STRING,
SIGLA_UE STRING,
DESCRICAO_UE STRING,
CODIGO_CARGO STRING,
DESCRICAO_CARGO STRING,
NOME_CANDIDATO STRING,
SEQUENCIAL_CANDIDATO STRING,
NUMERO_CANDIDATO STRING,
CPF_CANDIDATO STRING,
NOME_URNA_CANDIDATO STRING,
COD_SITUACAO_CANDIDATURA STRING,
DES_SITUACAO_CANDIDATURA STRING,
NUMERO_PARTIDO STRING,
SIGLA_PARTIDO STRING,
NOME_PARTIDO STRING,
CODIGO_LEGENDA STRING,
SIGLA_LEGENDA STRING,
COMPOSICAO_LEGENDA STRING,
NOME_LEGENDA STRING,
CODIGO_OCUPACAO STRING,
DESCRICAO_OCUPACAO STRING,
DATA_NASCIMENTO STRING,
NUM_TITULO_ELEITORAL_CANDIDATO STRING,
IDADE_DATA_ELEICAO STRING,
CODIGO_SEXO STRING,
DESCRICAO_SEXO STRING,
COD_GRAU_INSTRUCAO STRING,
DESCRICAO_GRAU_INSTRUCAO STRING,
CODIGO_ESTADO_CIVIL STRING,
DESCRICAO_ESTADO_CIVIL STRING,
CODIGO_NACIONALIDADE STRING,
DESCRICAO_NACIONALIDADE STRING,
SIGLA_UF_NASCIMENTO STRING,
CODIGO_MUNICIPIO_NASCIMENTO STRING,
NOME_MUNICIPIO_NASCIMENTO STRING,
DESPESA_MAX_CAMPANHA STRING,
COD_SIT_TOT_TURNO STRING,
DESC_SIT_TOT_TURNO STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
'separatorChar' = '\;',
'quoteChar'     = '\"',
'serialization.encoding'='ISO-8859-1'
)
STORED AS TEXTFILE;
Alter table candidato_2008 set location 's3://datascience2016/data/gzip/candidatos/candidato_2008.csv.gz';



create view votacao_secao_2008_macro_candidato as
select
    c.ANO_ELEICAO,
    c.NUM_TURNO,
    c.DESCRICAO_ELEICAO,
    c.SIGLA_UE,
    c.DESCRICAO_UE ,
    c.CODIGO_CARGO ,
    c.DESCRICAO_CARGO ,
    c.NOME_CANDIDATO ,
    c.SEQUENCIAL_CANDIDATO ,
    c.NUMERO_CANDIDATO ,
    c.CPF_CANDIDATO ,
    c.NOME_URNA_CANDIDATO ,
    c.COD_SITUACAO_CANDIDATURA ,
    c.DES_SITUACAO_CANDIDATURA ,
    c.NUMERO_PARTIDO ,
    c.SIGLA_PARTIDO ,
    c.NOME_PARTIDO ,
    c.CODIGO_LEGENDA ,
    c.SIGLA_LEGENDA ,
    c.COMPOSICAO_LEGENDA ,
    c.NOME_LEGENDA ,
    c.CODIGO_OCUPACAO,
    c.DESCRICAO_OCUPACAO,
    c.DATA_NASCIMENTO,
    c.NUM_TITULO_ELEITORAL_CANDIDATO,
    c.IDADE_DATA_ELEICAO,
    c.CODIGO_SEXO,
    c.DESCRICAO_SEXO,
    c.COD_GRAU_INSTRUCAO,
    c.DESCRICAO_GRAU_INSTRUCAO,
    c.CODIGO_ESTADO_CIVIL,
    c.DESCRICAO_ESTADO_CIVIL,
    "#NE#",
    "#NE#",
    c.CODIGO_NACIONALIDADE,
    c.DESCRICAO_NACIONALIDADE,
    c.SIGLA_UF_NASCIMENTO,
    c.CODIGO_MUNICIPIO_NASCIMENTO,
    c.NOME_MUNICIPIO_NASCIMENTO,
    c.DESPESA_MAX_CAMPANHA,
    c.COD_SIT_TOT_TURNO,
    c.DESC_SIT_TOT_TURNO,
    "#NE#",
    v.CODIGO_MACRO,
    v.NOME_MACRO,
    v.QTDE_VOTOS
from votacao_secao_2008_macro as v
join candidato_2008 as c
on v.SIGLA_UE=c.SIGLA_UE
AND v.ANO_ELEICAO=c.ANO_ELEICAO 
AND v.NUM_TURNO=c.NUM_TURNO
AND v.CODIGO_CARGO=c.CODIGO_CARGO
AND v.NUM_VOTAVEL=c.NUMERO_CANDIDATO;

create view votacao_secao_2008_uf_candidato as
select
    c.ANO_ELEICAO,
    c.NUM_TURNO,
    c.DESCRICAO_ELEICAO,
    c.SIGLA_UE,
    c.DESCRICAO_UE ,
    c.CODIGO_CARGO ,
    c.DESCRICAO_CARGO ,
    c.NOME_CANDIDATO ,
    c.SEQUENCIAL_CANDIDATO ,
    c.NUMERO_CANDIDATO ,
    c.CPF_CANDIDATO ,
    c.NOME_URNA_CANDIDATO ,
    c.COD_SITUACAO_CANDIDATURA ,
    c.DES_SITUACAO_CANDIDATURA ,
    c.NUMERO_PARTIDO ,
    c.SIGLA_PARTIDO ,
    c.NOME_PARTIDO ,
    c.CODIGO_LEGENDA ,
    c.SIGLA_LEGENDA ,
    c.COMPOSICAO_LEGENDA ,
    c.NOME_LEGENDA ,
    c.CODIGO_OCUPACAO,
    c.DESCRICAO_OCUPACAO,
    c.DATA_NASCIMENTO,
    c.NUM_TITULO_ELEITORAL_CANDIDATO,
    c.IDADE_DATA_ELEICAO,
    c.CODIGO_SEXO,
    c.DESCRICAO_SEXO,
    c.COD_GRAU_INSTRUCAO,
    c.DESCRICAO_GRAU_INSTRUCAO,
    c.CODIGO_ESTADO_CIVIL,
    c.DESCRICAO_ESTADO_CIVIL,
    "#NE#",
    "#NE#",
    c.CODIGO_NACIONALIDADE,
    c.DESCRICAO_NACIONALIDADE,
    c.SIGLA_UF_NASCIMENTO,
    c.CODIGO_MUNICIPIO_NASCIMENTO,
    c.NOME_MUNICIPIO_NASCIMENTO,
    c.DESPESA_MAX_CAMPANHA,
    c.COD_SIT_TOT_TURNO,
    c.DESC_SIT_TOT_TURNO,
    "#NE#",
    v.CODIGO_MACRO,
    v.NOME_MACRO,
    v.UF,
    v.NOME_UF,
    v.QTDE_VOTOS
from votacao_secao_2008_uf as v
join candidato_2008 as c
on v.SIGLA_UE=c.SIGLA_UE
AND v.ANO_ELEICAO=c.ANO_ELEICAO 
AND v.NUM_TURNO=c.NUM_TURNO
AND v.CODIGO_CARGO=c.CODIGO_CARGO
AND v.NUM_VOTAVEL=c.NUMERO_CANDIDATO;



create view votacao_secao_2008_meso_candidato as
select
    c.ANO_ELEICAO,
    c.NUM_TURNO,
    c.DESCRICAO_ELEICAO,
    c.SIGLA_UE,
    c.DESCRICAO_UE ,
    c.CODIGO_CARGO ,
    c.DESCRICAO_CARGO ,
    c.NOME_CANDIDATO ,
    c.SEQUENCIAL_CANDIDATO ,
    c.NUMERO_CANDIDATO ,
    c.CPF_CANDIDATO ,
    c.NOME_URNA_CANDIDATO ,
    c.COD_SITUACAO_CANDIDATURA ,
    c.DES_SITUACAO_CANDIDATURA ,
    c.NUMERO_PARTIDO ,
    c.SIGLA_PARTIDO ,
    c.NOME_PARTIDO ,
    c.CODIGO_LEGENDA ,
    c.SIGLA_LEGENDA ,
    c.COMPOSICAO_LEGENDA ,
    c.NOME_LEGENDA ,
    c.CODIGO_OCUPACAO,
    c.DESCRICAO_OCUPACAO,
    c.DATA_NASCIMENTO,
    c.NUM_TITULO_ELEITORAL_CANDIDATO,
    c.IDADE_DATA_ELEICAO,
    c.CODIGO_SEXO,
    c.DESCRICAO_SEXO,
    c.COD_GRAU_INSTRUCAO,
    c.DESCRICAO_GRAU_INSTRUCAO,
    c.CODIGO_ESTADO_CIVIL,
    c.DESCRICAO_ESTADO_CIVIL,
    "#NE#",
    "#NE#",
    c.CODIGO_NACIONALIDADE,
    c.DESCRICAO_NACIONALIDADE,
    c.SIGLA_UF_NASCIMENTO,
    c.CODIGO_MUNICIPIO_NASCIMENTO,
    c.NOME_MUNICIPIO_NASCIMENTO,
    c.DESPESA_MAX_CAMPANHA,
    c.COD_SIT_TOT_TURNO,
    c.DESC_SIT_TOT_TURNO,
    "#NE#",
    v.CODIGO_MACRO,
    v.NOME_MACRO,
    v.CODIGO_MESO,
    v.NOME_MESO,
    v.UF,
    v.NOME_UF,
    v.QTDE_VOTOS
from votacao_secao_2008_meso as v
join candidato_2008 as c
on v.SIGLA_UE=c.SIGLA_UE
AND v.ANO_ELEICAO=c.ANO_ELEICAO 
AND v.NUM_TURNO=c.NUM_TURNO
AND v.CODIGO_CARGO=c.CODIGO_CARGO
AND v.NUM_VOTAVEL=c.NUMERO_CANDIDATO;


create view votacao_secao_2008_micro_candidato as
select
    c.ANO_ELEICAO,
    c.NUM_TURNO,
    c.DESCRICAO_ELEICAO,
    c.SIGLA_UE,
    c.DESCRICAO_UE ,
    c.CODIGO_CARGO ,
    c.DESCRICAO_CARGO ,
    c.NOME_CANDIDATO ,
    c.SEQUENCIAL_CANDIDATO ,
    c.NUMERO_CANDIDATO ,
    c.CPF_CANDIDATO ,
    c.NOME_URNA_CANDIDATO ,
    c.COD_SITUACAO_CANDIDATURA ,
    c.DES_SITUACAO_CANDIDATURA ,
    c.NUMERO_PARTIDO ,
    c.SIGLA_PARTIDO ,
    c.NOME_PARTIDO ,
    c.CODIGO_LEGENDA ,
    c.SIGLA_LEGENDA ,
    c.COMPOSICAO_LEGENDA ,
    c.NOME_LEGENDA ,
    c.CODIGO_OCUPACAO,
    c.DESCRICAO_OCUPACAO,
    c.DATA_NASCIMENTO,
    c.NUM_TITULO_ELEITORAL_CANDIDATO,
    c.IDADE_DATA_ELEICAO,
    c.CODIGO_SEXO,
    c.DESCRICAO_SEXO,
    c.COD_GRAU_INSTRUCAO,
    c.DESCRICAO_GRAU_INSTRUCAO,
    c.CODIGO_ESTADO_CIVIL,
    c.DESCRICAO_ESTADO_CIVIL,
    "#NE#",
    "#NE#",
    c.CODIGO_NACIONALIDADE,
    c.DESCRICAO_NACIONALIDADE,
    c.SIGLA_UF_NASCIMENTO,
    c.CODIGO_MUNICIPIO_NASCIMENTO,
    c.NOME_MUNICIPIO_NASCIMENTO,
    c.DESPESA_MAX_CAMPANHA,
    c.COD_SIT_TOT_TURNO,
    c.DESC_SIT_TOT_TURNO,
    "#NE#",
    v.CODIGO_MACRO,
    v.NOME_MACRO,
    v.UF,
    v.NOME_UF,
    v.CODIGO_MESO,
    v.NOME_MESO,
    v.CODIGO_MICRO,
    v.NOME_MICRO,
    v.QTDE_VOTOS
from votacao_secao_2008_micro as v
join candidato_2008 as c
on v.SIGLA_UE=c.SIGLA_UE
AND v.ANO_ELEICAO=c.ANO_ELEICAO 
AND v.NUM_TURNO=c.NUM_TURNO
AND v.CODIGO_CARGO=c.CODIGO_CARGO
AND v.NUM_VOTAVEL=c.NUMERO_CANDIDATO;